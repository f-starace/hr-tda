Frequentist model on 5040 rows, K = 3
Frequentist model formula: cluster ~ age + episode_hr_mean + nadir_time_pct + patient_chronotype + se + sex + sri + waso
After dropping NAs, dataset has 5017 rows
Converting cluster variable to numeric codes...
Cluster mapping for mnlogit: {2: 2, 1: 1, 0: 0}
Converted cluster to numeric codes: [2 1 0]
Standardizing numerical columns: ['age', 'episode_hr_mean', 'nadir_time_pct', 'patient_chronotype', 'se', 'sri', 'waso']
Scaling parameters:
                         mean      scale
age                 46.427347  15.064315
episode_hr_mean     61.519813   6.824423
nadir_time_pct       0.637340   0.281631
patient_chronotype   9.675248   1.106635
se                  81.231302  14.441248
sri                 71.662998  14.441979
waso                87.773769  65.473660
Dropping array columns: ['hr_vector', 'hr_vector_times', 'slope', 'tda_vec', 'hr_eq']
Target variable: patient_chronotype
Excluding ID-like column from predictors: episode_id
Dropping ID column from model data: episode_id
WARNING: Column 'is_main' has only 1 unique value(s). Removing from model.
WARNING: Column 'keep' has only 1 unique value(s). Removing from model.
Converting sex variable from F/M to numeric (0=F, 1=M)
Found sex values: ['M' 'F']
Sex variable mapped to: [1 0]
Fitting multinomial logit model...
Model converged successfully.
Log-likelihood: -3728.78
Pseudo R-squared: 0.3169
Computing cluster-robust standard errors...
WARNING: No robust covariance method found. Using non-robust results.

Model summary with standard errors:
                          MNLogit Regression Results                          
==============================================================================
Dep. Variable:                cluster   No. Observations:                 5017
Model:                        MNLogit   Df Residuals:                     4999
Method:                           MLE   Df Model:                           16
Date:                Wed, 21 May 2025   Pseudo R-squ.:                  0.3169
Time:                        01:51:42   Log-Likelihood:                -3728.8
converged:                       True   LL-Null:                       -5458.5
Covariance Type:            nonrobust   LLR p-value:                     0.000
======================================================================================
         cluster=1       coef    std err          z      P>|z|      [0.025      0.975]
--------------------------------------------------------------------------------------
Intercept             -0.2153      0.057     -3.806      0.000      -0.326      -0.104
age                   -0.1247      0.040     -3.092      0.002      -0.204      -0.046
episode_hr_mean        0.4796      0.044     10.790      0.000       0.392       0.567
nadir_time_pct         1.0942      0.062     17.652      0.000       0.973       1.216
patient_chronotype     0.0686      0.040      1.698      0.090      -0.011       0.148
se                     0.0981      0.086      1.136      0.256      -0.071       0.268
sex                   -0.3667      0.074     -4.951      0.000      -0.512      -0.222
sri                    0.1873      0.037      5.016      0.000       0.114       0.260
waso                  -0.1753      0.081     -2.156      0.031      -0.335      -0.016
--------------------------------------------------------------------------------------
         cluster=2       coef    std err          z      P>|z|      [0.025      0.975]
--------------------------------------------------------------------------------------
Intercept             -1.0279      0.075    -13.746      0.000      -1.175      -0.881
age                   -0.1269      0.053     -2.415      0.016      -0.230      -0.024
episode_hr_mean        0.3498      0.060      5.831      0.000       0.232       0.467
nadir_time_pct        -2.0001      0.067    -29.729      0.000      -2.132      -1.868
patient_chronotype     0.1676      0.052      3.205      0.001       0.065       0.270
se                     0.1294      0.116      1.119      0.263      -0.097       0.356
sex                   -0.1494      0.100     -1.499      0.134      -0.345       0.046
sri                    0.1203      0.050      2.392      0.017       0.022       0.219
waso                  -0.1424      0.106     -1.342      0.180      -0.350       0.066
======================================================================================
Saved frequentist summary to results/eq_resample_clust_tda_nadir_umap_kmeans_3_nw_1.0_k_2-10/models_outputs/patient_chronotype_to_cluster/freq_multinomial_model_chronotype_summary.txt
Saved scaling parameters to results/eq_resample_clust_tda_nadir_umap_kmeans_3_nw_1.0_k_2-10/models_outputs/patient_chronotype_to_cluster/freq_multinomial_model_chronotype_summary_scaling.csv
Computing 5-fold cross-validation...
Error in CV fold: MNLogit.loglikeobs() got an unexpected keyword argument 'exog'
Error in CV fold: MNLogit.loglikeobs() got an unexpected keyword argument 'exog'
Error in CV fold: MNLogit.loglikeobs() got an unexpected keyword argument 'exog'
Error in CV fold: MNLogit.loglikeobs() got an unexpected keyword argument 'exog'
Error in CV fold: MNLogit.loglikeobs() got an unexpected keyword argument 'exog'
Cross-validation failed on all folds
